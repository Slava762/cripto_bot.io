<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Trading Terminal</title>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        :root {
            --bg-color: #131722;
            --panel-color: #1e222d;
            --border-color: #2a2e39;
            --text-primary: #d1d4dc;
            --text-secondary: #b2b5be;
            --accent-color: #2962ff;
        }
        html, body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
        }
        .main-container {
            display: flex;
            width: 100%;
            height: 100%;
        }
        .chart-section {
            flex-grow: 1;
            height: 100%;
        }
        .controls-section {
            width: 300px;
            flex-shrink: 0;
            height: 100%;
            background-color: var(--panel-color);
            border-left: 1px solid var(--border-color);
            padding: 15px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .lang-switcher {
            position: absolute;
            top: 10px;
            right: 15px;
        }
        .lang-btn {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 5px 10px;
            cursor: pointer;
            margin-left: 5px;
            border-radius: 4px;
        }
        .lang-btn.active {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            color: #fff;
        }
        .form-container {
            margin-top: 50px;
        }
        .form-tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px;
            cursor: pointer;
            flex-grow: 1;
            text-align: center;
            background-color: var(--border-color);
            border-bottom: 2px solid #4a4e59;
            color: var(--text-secondary);
        }
        .tab.active {
            background-color: var(--panel-color);
            border-bottom-color: var(--accent-color);
            color: #fff;
        }
        .form-content { display: none; }
        .form-content.active { display: block; }
        h3 { text-align: center; margin-bottom: 20px; font-weight: 500;}
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-size: 14px; color: var(--text-secondary); }
        input {
            width: 100%;
            padding: 10px;
            background-color: var(--border-color);
            border: 1px solid #4a4e59;
            border-radius: 4px;
            color: var(--text-primary);
            box-sizing: border-box;
        }
        .submit-button {
            width: 100%;
            padding: 12px;
            background-color: var(--accent-color);
            border: none;
            border-radius: 4px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <div class="main-container">
        <div id="chart-container" class="chart-section"></div>
        <div class="controls-section">
            <div class="lang-switcher">
                <button id="lang-en" class="lang-btn" onclick="setLanguage('en')">EN</button>
                <button id="lang-ru" class="lang-btn" onclick="setLanguage('ru')">RU</button>
            </div>
            <div class="form-container">
                <div class="form-tabs">
                    <div id="tab-login" class="tab" onclick="switchTab('login')" data-key="login_tab"></div>
                    <div id="tab-register" class="tab" onclick="switchTab('register')" data-key="register_tab"></div>
                </div>
                <div id="login-form" class="form-content">
                    <h3 data-key="auth_header"></h3>
                    <div class="input-group">
                        <label data-key="email_label"></label>
                        <input type="email" required>
                    </div>
                    <div class="input-group">
                        <label data-key="password_label"></label>
                        <input type="password" required>
                    </div>
                    <button class="submit-button" data-key="login_button"></button>
                </div>
                <div id="register-form" class="form-content">
                    <h3 data-key="register_header"></h3>
                    <div class="input-group">
                        <label data-key="username_label"></label>
                        <input type="text" required>
                    </div>
                    <div class="input-group">
                        <label data-key="email_label"></label>
                        <input type="email" required>
                    </div>
                    <div class="input-group">
                        <label data-key="password_label"></label>
                        <input type="password" required>
                    </div>
                    <button class="submit-button" data-key="register_button"></button>
                </div>
            </div>
        </div>
    </div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        try {
            // DICTIONARY
            const translations = {
                en: { login_tab: "Login", register_tab: "Register", auth_header: "Authorization", email_label: "Email", password_label: "Password", login_button: "Login", register_header: "Create Account", username_label: "Username", register_button: "Register" },
                ru: { login_tab: "Вход", register_tab: "Регистрация", auth_header: "Авторизация", email_label: "Email", password_label: "Пароль", login_button: "Войти", register_header: "Создать аккаунт", username_label: "Имя пользователя", register_button: "Зарегистрироваться" }
            };

            // GLOBAL FUNCTIONS
            window.setLanguage = function(lang) {
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.getAttribute('data-key');
                    if(translations[lang]?.[key]) el.textContent = translations[lang][key];
                });
                document.querySelectorAll('.lang-btn.active').forEach(b => b.classList.remove('active'));
                const langBtn = document.getElementById(`lang-${lang}`);
                if (langBtn) langBtn.classList.add('active');
            };

            window.switchTab = function(tabName) {
                document.querySelectorAll('.form-content').forEach(c => c.classList.remove('active'));
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

                const form = document.getElementById(`${tabName}-form`);
                const tab = document.getElementById(`tab-${tabName}`);
                if (form) form.classList.add('active');
                if (tab) tab.classList.add('active');
            };

            // SET DEFAULTS FIRST
            switchTab('login');
            setLanguage('en');

            // CHART INITIALIZATION
            const chartContainer = document.getElementById('chart-container');
            if (chartContainer) {
                const chart = LightweightCharts.createChart(chartContainer, {
                    autoSize: true,
                    layout: { backgroundColor: '#131722', textColor: '#d1d4dc' },
                    grid: { vertLines: { color: '#1e222d' }, horzLines: { color: '#1e222d' } }
                });
                const areaSeries = chart.addAreaSeries({
                    topColor: 'rgba(76, 175, 80, 0.56)', bottomColor: 'rgba(76, 175, 80, 0.04)',
                    lineColor: 'rgba(76, 175, 80, 1)', lineWidth: 2
                });
                const data = []; let time = Math.floor(Date.now() / 1000);
                for (let i = 0; i < 150; i++) { data.push({ time: time - (150 - i) * 60, value: 100 + (Math.random() - 0.5) * 5 * i * 0.1 }); }
                areaSeries.setData(data);
                chart.timeScale().fitContent();
            }

            // TELEGRAM API
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
            }
            
            // VISUAL CONFIRMATION
            document.body.style.border = '3px solid limegreen';

        } catch (e) {
            // Если что-то пойдет не так, мы увидим красную рамку
            document.body.style.border = '3px solid red';
            console.error(e);
        }
    });
</script>
</body>
</html>
